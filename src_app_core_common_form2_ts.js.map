{"version":3,"file":"src_app_core_common_form2_ts.js","mappings":"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","sources":["./src/app/core/common/form2.ts"],"sourcesContent":["import { FormBuilder, FormControl, FormControlOptions, FormGroup, Validators } from '@angular/forms'\nimport { Directive, ElementRef, ViewChild } from '@angular/core'\nimport { FormValidators } from '@core/utils/form-validators'\nimport { AutoDestroy } from '@core/common/auto-destroy'\nimport { finalize } from 'rxjs'\n\n@Directive()\nexport abstract class Form extends AutoDestroy {\n  @ViewChild('saveBtn') saveButton: ElementRef\n  @ViewChild('cancelBtn') cancelButton: ElementRef\n\n  public form: FormGroup\n\n  public getError(field: string, error: string) {\n    return this.form.controls[field]?.errors?.[error]\n  }\n\n  public setError(field: string, error: string, message: string|true = true) {\n    this.form.controls[field].setErrors({ [error]: message })\n  }\n\n  public getFC(name: string, i: number|null = null, validations: Array<'required'>|null = null) {\n    name = this.getFCName(name, i, null, validations)\n\n    return this.form.controls[name]\n  }\n\n  protected getFCValue(name: string, i: number|null = null) {\n    if (i !== null) {\n      name = `${name}-${i}`\n    }\n\n    return this.form.controls[name]?.value\n  }\n\n  protected _initFormControl(fb: FormBuilder, formFields: object, validators: any = null) {\n    let options:object = {}\n    if (validators) {\n      options = { validators }\n      // options['validators'] = validators\n    }\n\n    this.form = fb.group(formFields, options)\n    // this.form = new FormGroup<any>(formFields, options)\n  }\n\n  protected addController(name: string, val: any|null = null, ops: FormControlOptions|null = null) {\n    if (! this.form.contains(name)) {\n      this.form.addControl(name, new FormControl(val, ops))\n    }\n\n    if (val !== null) {\n      this.form.controls[name].setValue(val)\n    }\n  }\n\n  public setFCBYName(name: string, i: number|null, val: any = '', validations: Array<'required'>|null = null) {\n    return this.getFCName(name, i, val, validations)\n  }\n\n  /**\n   * disable form buttons\n   */\n  protected handleSubmit() {\n    const saveBtn = this.saveButton.nativeElement\n    const cancelBtn = this.cancelButton?.nativeElement\n\n    if (cancelBtn) {\n      cancelBtn.disabled = true\n    }\n\n    saveBtn.disabled = true\n    saveBtn.dataset['innerHtml'] = saveBtn.innerHTML\n    this.saveButton.nativeElement.innerHTML = '<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>'\n\n    return finalize(() => {\n      saveBtn.innerHTML = saveBtn.dataset['innerHtml']\n      saveBtn.disabled = false\n\n      if (cancelBtn) {\n        cancelBtn.disabled = false\n      }\n\n    })\n  }\n\n  private getFCName(name: string, i: number|null, val: any = '', validations: Array<'required'>|null) {\n    if (i !== null) {\n      name = `${name}-${i}`\n    }\n\n    const validators: any = []\n\n    validations?.forEach((v) => validators.push(Validators[v]))\n\n    this.addController(name, val, validators as FormControlOptions)\n\n    return name\n  }\n}\n"],"names":["FormControl","Validators","AutoDestroy","finalize","Form","getError","field","error","form","controls","errors","setError","message","setErrors","getFC","name","i","validations","getFCName","getFCValue","value","_initFormControl","fb","formFields","validators","options","group","addController","val","ops","contains","addControl","setValue","setFCBYName","handleSubmit","saveBtn","saveButton","nativeElement","cancelBtn","cancelButton","disabled","dataset","innerHTML","forEach","v","push","viewQuery"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}